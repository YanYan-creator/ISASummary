<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Adrian's Dashboard</title>
    <style>
        :root {
            --radius: 18px;
            --shadow: 0 14px 40px rgba(0, 0, 0, .45);

            /* Dark default */
            --page-bg1: #070A12;
            --page-bg2: #0B1022;

            --panel-bg: rgba(12, 18, 40, .78);
            --card-bg: rgba(255, 255, 255, .06);

            --text: rgba(255, 255, 255, .92);
            --muted: rgba(255, 255, 255, .72);

            --border: rgba(255, 255, 255, .14);
            --border2: rgba(255, 255, 255, .20);

            --chip-bg: rgba(255, 255, 255, .06);
            --chip-bg-hover: rgba(255, 255, 255, .09);

            --input-bg: rgba(0, 0, 0, .26);

            --accent-a: #7C5CFF;
            --accent-b: #22D3EE;
        }

        :root[data-theme="light"] {
            --page-bg1: #F6F7FB;
            --page-bg2: #ECEFF7;

            --panel-bg: rgba(255, 255, 255, .92);
            --card-bg: rgba(0, 0, 0, .03);

            --text: rgba(0, 0, 0, .88);
            --muted: rgba(0, 0, 0, .62);

            --border: rgba(0, 0, 0, .10);
            --border2: rgba(0, 0, 0, .16);

            --chip-bg: rgba(0, 0, 0, .04);
            --chip-bg-hover: rgba(0, 0, 0, .06);

            --input-bg: rgba(255, 255, 255, .82);

            --shadow: 0 14px 40px rgba(18, 22, 45, .14);
        }

        * {
            box-sizing: border-box;
        }

        html,
        body {
            height: 100%;
        }

        body {
            margin: 0;
            font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
            color: var(--text);
            background:
                radial-gradient(1200px 800px at 20% 10%, color-mix(in srgb, var(--accent-a) 28%, transparent), transparent 55%),
                radial-gradient(900px 700px at 80% 70%, color-mix(in srgb, var(--accent-b) 20%, transparent), transparent 55%),
                linear-gradient(180deg, var(--page-bg1), var(--page-bg2));
            overflow-x: hidden;
        }

        .app {
            min-height: 100%;
            display: flex;
            gap: 22px;
            padding: 22px;
            align-items: flex-start;
        }

        .rail {
            width: 260px;
            min-width: 240px;
            background: var(--panel-bg);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            padding: 16px;
            position: sticky;
            top: 18px;
            height: calc(100vh - 44px);
            display: flex;
            flex-direction: column;
            gap: 14px;
            backdrop-filter: blur(10px);
            overflow: hidden;
        }

        .brandRow {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            gap: 10px;
            padding: 10px 10px 6px 10px;
        }

        .brandLeft {
            display: flex;
            align-items: center;
            gap: 10px;
            min-width: 0;
        }

        .logoImg {
            width: 34px;
            height: 34px;
            border-radius: 12px;
            border: 1px solid var(--border2);
            background: var(--card-bg);
            object-fit: contain;
            padding: 6px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, .25);
            display: block;
            flex: 0 0 34px;
        }

        .themeBtn {
            appearance: none;
            border: 1px solid var(--border);
            background: var(--card-bg);
            color: var(--text);
            padding: 8px 10px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 12px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: background .12s ease, border-color .12s ease, transform .12s ease;
            user-select: none;
            flex: 0 0 auto;
        }

        .themeBtn:hover {
            background: color-mix(in srgb, var(--card-bg) 75%, white 10%);
            border-color: var(--border2);
            transform: translateY(-1px);
        }

        .themeBtn:active {
            transform: translateY(0px);
        }

        .avatarCard {
            border: 1px solid var(--border);
            background: var(--card-bg);
            border-radius: 16px;
            padding: 10px;
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .avatarFrame {
            width: 54px;
            height: 54px;
            border-radius: 16px;
            border: 1px solid var(--border2);
            background:
                radial-gradient(circle at 30% 30%, rgba(255, 255, 255, .22), transparent 60%),
                linear-gradient(135deg, color-mix(in srgb, var(--accent-a) 35%, transparent), color-mix(in srgb, var(--accent-b) 22%, transparent));
            overflow: hidden;
            flex: 0 0 54px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 10px 24px rgba(0, 0, 0, .18);
        }

        .avatarFrame img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }

        .avatarMeta {
            display: flex;
            flex-direction: column;
            gap: 2px;
            min-width: 0;
        }

        .avatarMeta .name {
            font-size: 13px;
            font-weight: 700;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .avatarMeta .hint {
            font-size: 12px;
            color: var(--muted);
        }

        .btns {
            display: flex;
            flex-direction: column;
            gap: 10px;
            padding: 4px 6px;
            flex: 1;
            overflow: auto;
            padding-bottom: 10px;
        }

        .navbtn {
            appearance: none;
            border: 1px solid var(--border);
            background: var(--card-bg);
            color: var(--text);
            padding: 12px 12px;
            border-radius: 14px;
            cursor: pointer;
            text-align: left;
            font-size: 13px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: transform .12s ease, border-color .12s ease, background .12s ease;
            flex: 0 0 auto;
        }

        .navbtn:hover {
            transform: translateY(-1px);
            border-color: var(--border2);
            background: color-mix(in srgb, var(--card-bg) 82%, white 10%);
        }

        .navbtn:active {
            transform: translateY(0px);
        }

        .navbtn .left {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 650;
            letter-spacing: .2px;
        }

        .dot {
            width: 10px;
            height: 10px;
            border-radius: 999px;
            background: color-mix(in srgb, var(--text) 22%, transparent);
            box-shadow: inset 0 0 0 2px rgba(0, 0, 0, .10);
        }

        :root[data-theme="light"] .dot {
            box-shadow: inset 0 0 0 2px rgba(255, 255, 255, .55);
        }

        .navbtn.active {
            background: linear-gradient(135deg, color-mix(in srgb, var(--accent-a) 18%, transparent), color-mix(in srgb, var(--accent-b) 10%, transparent));
            border-color: color-mix(in srgb, var(--accent-a) 45%, var(--border));
        }

        .navbtn.active .dot {
            background: linear-gradient(135deg, var(--accent-a), var(--accent-b));
        }

        .kbd {
            font-size: 11px;
            color: var(--muted);
            border: 1px solid var(--border);
            background: color-mix(in srgb, var(--card-bg) 85%, black 8%);
            padding: 3px 7px;
            border-radius: 10px;
        }

        :root[data-theme="light"] .kbd {
            background: rgba(255, 255, 255, .85);
        }

        .socialRow {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            padding: 10px 6px 0 6px;
            border-top: 1px solid color-mix(in srgb, var(--border) 60%, transparent);
        }

        .socialIcon {
            width: 38px;
            height: 38px;
            border-radius: 14px;
            border: 1px solid var(--border);
            background: var(--card-bg);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: transform .18s ease, box-shadow .18s ease, border-color .18s ease, background .18s ease;
            text-decoration: none;
            color: var(--text);
            user-select: none;
        }

        .socialIcon:hover {
            transform: rotate(10deg) translateY(-1px);
            border-color: color-mix(in srgb, var(--accent-b) 55%, var(--border));
            box-shadow:
                0 0 0 3px color-mix(in srgb, var(--accent-a) 18%, transparent),
                0 0 22px color-mix(in srgb, var(--accent-b) 25%, transparent);
            background: color-mix(in srgb, var(--card-bg) 75%, white 10%);
        }

        .socialIcon svg {
            width: 18px;
            height: 18px;
            opacity: .95;
        }

        /* Quote under nav (center + glow) */
        .quoteBox {
            border-top: 1px solid color-mix(in srgb, var(--border) 60%, transparent);
            padding: 14px 10px 0 10px;
        }

        .quoteCard {
            position: relative;
            border: 1px solid color-mix(in srgb, var(--border) 70%, transparent);
            background: linear-gradient(135deg,
                    color-mix(in srgb, var(--accent-a) 10%, transparent),
                    color-mix(in srgb, var(--accent-b) 8%, transparent));
            border-radius: 16px;
            padding: 14px 12px;
            text-align: center;
            box-shadow:
                0 0 0 3px color-mix(in srgb, var(--accent-a) 14%, transparent),
                0 0 22px color-mix(in srgb, var(--accent-b) 20%, transparent),
                0 10px 26px rgba(0, 0, 0, .18);
        }

        .quoteCard::before {
            content: "";
            position: absolute;
            inset: -2px;
            border-radius: 18px;
            pointer-events: none;
            background:
                radial-gradient(420px 220px at 20% 20%, color-mix(in srgb, var(--accent-a) 18%, transparent), transparent 60%),
                radial-gradient(420px 220px at 80% 80%, color-mix(in srgb, var(--accent-b) 14%, transparent), transparent 60%);
            opacity: .9;
            filter: blur(8px);
        }

        .quoteText {
            position: relative;
            z-index: 1;
            color: color-mix(in srgb, var(--text) 92%, transparent);
            font-size: 12.5px;
            line-height: 1.55;
            white-space: pre-line;
            text-shadow: 0 0 14px color-mix(in srgb, var(--accent-a) 18%, transparent);
        }

        .quoteMark {
            font-weight: 800;
            color: color-mix(in srgb, var(--text) 85%, transparent);
        }

        .railFooter {
            padding: 8px 10px 10px 10px;
            border-top: 1px solid color-mix(in srgb, var(--border) 60%, transparent);
            color: var(--muted);
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 10px;
            flex: 0 0 auto;
        }

        .main {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            padding: 6px 6px 20px 6px;
        }

        .wrap {
            width: min(1100px, 100%);
            display: grid;
            grid-template-columns: 1.35fr 1fr;
            gap: 18px;
            align-items: start;
        }

        .card {
            background: var(--panel-bg);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            padding: 18px;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .card::before {
            content: "";
            position: absolute;
            inset: -2px;
            background:
                radial-gradient(500px 260px at 20% 10%, color-mix(in srgb, var(--accent-a) 18%, transparent), transparent 60%),
                radial-gradient(500px 260px at 85% 85%, color-mix(in srgb, var(--accent-b) 14%, transparent), transparent 60%);
            pointer-events: none;
        }

        .cardHeader {
            position: relative;
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            gap: 12px;
            margin-bottom: 12px;
        }

        .cardHeader h2 {
            margin: 0;
            font-size: 16px;
            letter-spacing: .2px;
        }

        .pill {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 6px 10px;
            border-radius: 999px;
            border: 1px solid var(--border);
            background: var(--card-bg);
            color: var(--muted);
            font-size: 12px;
            white-space: nowrap;
        }

        .muted {
            color: var(--muted);
        }

        .small {
            font-size: 12px;
        }

        .scriptBox {
            position: relative;
            border: 1px solid color-mix(in srgb, var(--border) 70%, transparent);
            background: color-mix(in srgb, var(--card-bg) 86%, black 6%);
            border-radius: 14px;
            padding: 12px 12px;
            line-height: 1.55;
        }

        :root[data-theme="light"] .scriptBox {
            background: rgba(255, 255, 255, .88);
        }

        .section {
            position: relative;
            margin-top: 14px;
            padding-top: 12px;
            border-top: 1px solid color-mix(in srgb, var(--border) 65%, transparent);
        }

        .sectionTitle {
            margin: 0 0 10px 0;
            font-size: 13px;
            font-weight: 700;
            color: color-mix(in srgb, var(--text) 92%, transparent);
            letter-spacing: .2px;
        }

        .q {
            display: flex;
            gap: 10px;
            align-items: flex-start;
            padding: 10px 10px;
            border: 1px solid color-mix(in srgb, var(--border) 75%, transparent);
            background: var(--card-bg);
            border-radius: 14px;
            margin-bottom: 10px;
        }

        .qIcon {
            width: 24px;
            height: 24px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid var(--border);
            background: color-mix(in srgb, var(--card-bg) 80%, white 8%);
            flex: 0 0 24px;
            font-size: 13px;
            color: color-mix(in srgb, var(--text) 92%, transparent);
            margin-top: 1px;
        }

        .qBody {
            flex: 1;
        }

        .qText {
            margin: 0 0 8px 0;
            font-size: 13px;
            font-weight: 650;
            line-height: 1.35;
        }

        .input {
            width: 100%;
            border-radius: 12px;
            border: 1px solid var(--border);
            background: var(--input-bg);
            color: var(--text);
            padding: 10px 10px;
            font-size: 13px;
            outline: none;
        }

        .input::placeholder {
            color: color-mix(in srgb, var(--muted) 70%, transparent);
        }

        .input:focus {
            border-color: color-mix(in srgb, var(--accent-a) 50%, var(--border));
            box-shadow: 0 0 0 3px color-mix(in srgb, var(--accent-a) 18%, transparent);
        }

        .choices {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 8px;
        }

        .chip {
            position: relative;
            border: 1px solid var(--border);
            background: var(--chip-bg);
            padding: 8px 10px;
            border-radius: 999px;
            font-size: 12px;
            cursor: pointer;
            user-select: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: transform .12s ease, border-color .12s ease, background .12s ease;
        }

        .chip:hover {
            transform: translateY(-1px);
            border-color: var(--border2);
            background: var(--chip-bg-hover);
        }

        .chip input {
            position: absolute;
            opacity: 0;
            pointer-events: none;
        }

        .chip .box {
            width: 14px;
            height: 14px;
            border-radius: 4px;
            border: 2px solid color-mix(in srgb, var(--text) 28%, transparent);
            box-shadow: inset 0 0 0 2px rgba(0, 0, 0, .10);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            line-height: 1;
        }

        .chip.selected {
            border-color: color-mix(in srgb, var(--accent-a) 45%, var(--border));
            background: linear-gradient(135deg, color-mix(in srgb, var(--accent-a) 18%, transparent), color-mix(in srgb, var(--accent-b) 10%, transparent));
        }

        .chip.selected .box {
            border-color: color-mix(in srgb, var(--accent-a) 90%, white 10%);
            background: color-mix(in srgb, var(--accent-a) 18%, transparent);
        }

        .lockRow {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 10px;
            margin-top: 8px;
            flex-wrap: wrap;
        }

        .btnRow {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            align-items: center;
            justify-content: flex-end;
        }

        .linkBtn {
            appearance: none;
            border: 1px solid var(--border);
            background: var(--chip-bg);
            color: color-mix(in srgb, var(--text) 92%, transparent);
            padding: 6px 10px;
            border-radius: 12px;
            font-size: 12px;
            cursor: pointer;
            transition: border-color .12s ease, background .12s ease, transform .12s ease;
            user-select: none;
        }

        .linkBtn:hover {
            border-color: var(--border2);
            background: var(--chip-bg-hover);
            transform: translateY(-1px);
        }

        .linkBtn:active {
            transform: translateY(0px);
        }

        .summaryCard {
            position: sticky;
            top: 18px;
            height: calc(100vh - 44px);
            display: flex;
            flex-direction: column;
            padding-bottom: 14px;
        }

        .summarySticky {
            position: relative;
            z-index: 2;
            display: flex;
            flex-direction: column;
            gap: 10px;
            padding-right: 2px;
            margin-bottom: 10px;
        }

        .summaryScroll {
            position: relative;
            z-index: 1;
            overflow: auto;
            padding-right: 6px;
            flex: 1;
            border-top: 1px solid color-mix(in srgb, var(--border) 60%, transparent);
            padding-top: 12px;
        }

        .summaryList {
            position: relative;
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 0;
        }

        .sumRow {
            border: 1px solid color-mix(in srgb, var(--border) 75%, transparent);
            background: var(--card-bg);
            border-radius: 14px;
            padding: 12px 12px;
        }

        .sumLabel {
            font-size: 12px;
            color: var(--muted);
            margin-bottom: 4px;
            letter-spacing: .2px;
        }

        .sumValue {
            font-size: 14px;
            font-weight: 650;
            line-height: 1.35;
            white-space: pre-wrap;
        }

        .textarea {
            width: 100%;
            min-height: 110px;
            resize: vertical;
            border-radius: 12px;
            border: 1px solid var(--border);
            background: var(--input-bg);
            color: var(--text);
            padding: 10px 10px;
            font-size: 13px;
            outline: none;
            line-height: 1.4;
        }

        .textarea:focus {
            border-color: color-mix(in srgb, var(--accent-a) 50%, var(--border));
            box-shadow: 0 0 0 3px color-mix(in srgb, var(--accent-a) 18%, transparent);
        }

        .fieldRow {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .miniBox {
            border: 1px solid color-mix(in srgb, var(--border) 75%, transparent);
            background: var(--card-bg);
            border-radius: 14px;
            padding: 12px 12px;
        }

        .miniTitle {
            font-size: 12px;
            color: var(--muted);
            margin-bottom: 8px;
            letter-spacing: .2px;
        }

        .miniValue {
            font-size: 14px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .plusRow {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .addBtn {
            appearance: none;
            border: 1px solid var(--border);
            background: var(--chip-bg);
            color: var(--text);
            padding: 7px 10px;
            border-radius: 999px;
            font-size: 12px;
            cursor: pointer;
            transition: transform .12s ease, border-color .12s ease, background .12s ease;
            user-select: none;
        }

        .addBtn:hover {
            transform: translateY(-1px);
            border-color: var(--border2);
            background: var(--chip-bg-hover);
        }

        .tokenRow {
            margin-top: 10px;
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .token {
            border: 1px solid var(--border);
            background: color-mix(in srgb, var(--chip-bg) 85%, black 6%);
            border-radius: 999px;
            padding: 6px 9px;
            font-size: 12px;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            user-select: none;
            transition: transform .12s ease, border-color .12s ease, background .12s ease;
        }

        .token:hover {
            transform: translateY(-1px);
            border-color: color-mix(in srgb, var(--accent-b) 45%, var(--border));
            background: color-mix(in srgb, var(--chip-bg-hover) 85%, black 6%);
        }

        .x {
            width: 16px;
            height: 16px;
            border-radius: 999px;
            border: 1px solid var(--border);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            color: var(--muted);
        }

        .pickerBox {
            border: 1px solid var(--border);
            background: var(--input-bg);
            border-radius: 12px;
            padding: 10px 10px;
            cursor: text;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: border-color .12s ease, box-shadow .12s ease;
        }

        .pickerBox:focus-within {
            border-color: color-mix(in srgb, var(--accent-a) 50%, var(--border));
            box-shadow: 0 0 0 3px color-mix(in srgb, var(--accent-a) 18%, transparent);
        }

        .pickerBox input {
            border: none;
            outline: none;
            background: transparent;
            color: var(--text);
            font-size: 13px;
            width: 100%;
            min-width: 0;
            font-family: inherit;
        }

        .pickerHint {
            font-size: 12px;
            color: var(--muted);
            margin-top: 6px;
        }

        @media (max-width: 980px) {
            .wrap {
                grid-template-columns: 1fr;
            }

            .summaryCard {
                position: relative;
                top: auto;
                height: auto;
            }

            .summaryScroll {
                max-height: none;
            }
        }

        @media (max-width: 720px) {
            .app {
                flex-direction: column;
                padding: 14px;
                gap: 14px;
            }

            .rail {
                position: relative;
                top: auto;
                height: auto;
                width: 100%;
            }

            .btns {
                display: grid;
                grid-template-columns: 1fr 1fr;
                overflow: visible;
            }

            .main {
                padding: 0;
            }

            .summaryCard {
                position: relative;
                top: auto;
                height: auto;
            }
        }
    </style>
</head>

<body>
    <div class="app">
        <aside class="rail">
            <div class="brandRow">
                <div class="brandLeft">
                    <img class="logoImg" src="Logo.png" alt="Logo" />
                </div>

                <button class="themeBtn" id="themeToggle" type="button" aria-label="Toggle theme">
                    <span id="themeIcon" aria-hidden="true">☾</span>
                    <span id="themeText">Dark</span>
                </button>
            </div>

            <div class="avatarCard">
                <div class="avatarFrame" aria-label="Your photo">
                    <img id="avatarImg" src="Photo.png" alt="Your photo" />
                </div>
                <div class="avatarMeta">
                    <div class="name">ISA Adrian</div>
                    <div class="hint">Power Real State</div>
                </div>
            </div>

            <div class="btns" id="nav" aria-label="Navigation">
                <button class="navbtn active" data-section="Location" type="button"><span class="left"><span
                            class="dot"></span>Location</span><span class="kbd">1</span></button>
                <button class="navbtn" data-section="Price" type="button"><span class="left"><span
                            class="dot"></span>Price</span><span class="kbd">2</span></button>
                <button class="navbtn" data-section="Motivation" type="button"><span class="left"><span
                            class="dot"></span>Motivation</span><span class="kbd">3</span></button>
                <button class="navbtn" data-section="Agent" type="button"><span class="left"><span
                            class="dot"></span>Agent</span><span class="kbd">4</span></button>
                <button class="navbtn" data-section="Mortgage" type="button"><span class="left"><span
                            class="dot"></span>Mortgage</span><span class="kbd">5</span></button>
                <button class="navbtn" data-section="Appointment" type="button"><span class="left"><span
                            class="dot"></span>Appointment</span><span class="kbd">6</span></button>
            </div>

            <div class="socialRow" aria-label="Social links">
                <a class="socialIcon" href="https://www.facebook.com/adriand.alasco/" target="_blank"
                    rel="noopener noreferrer" aria-label="Facebook">
                    <svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                        <path
                            d="M13.5 22v-8h2.7l.4-3H13.5V9.1c0-.9.2-1.5 1.5-1.5H16.7V5c-.3 0-1.4-.1-2.7-.1-2.7 0-4.5 1.6-4.5 4.6V11H7v3h2.5v8h4z" />
                    </svg>
                </a>

                <a class="socialIcon" href="https://www.linkedin.com/in/adrian-alasco/" target="_blank"
                    rel="noopener noreferrer" aria-label="LinkedIn">
                    <svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                        <path
                            d="M6.9 6.6a2 2 0 1 1-4 0 2 2 0 0 1 4 0zM3.3 21h3.2V9H3.3v12zM10 9h3v1.6h.1c.4-.8 1.6-1.8 3.3-1.8 3.5 0 4.2 2.3 4.2 5.3V21h-3.2v-5.3c0-1.3 0-3-1.8-3s-2.1 1.4-2.1 2.9V21H10V9z" />
                    </svg>
                </a>

                <a class="socialIcon" href="https://www.instagram.com/yanyan.alasco" target="_blank"
                    rel="noopener noreferrer" aria-label="Instagram">
                    <svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                        <path
                            d="M7.5 2h9A5.5 5.5 0 0 1 22 7.5v9A5.5 5.5 0 0 1 16.5 22h-9A5.5 5.5 0 0 1 2 16.5v-9A5.5 5.5 0 0 1 7.5 2zm0 2A3.5 3.5 0 0 0 4 7.5v9A3.5 3.5 0 0 0 7.5 20h9a3.5 3.5 0 0 0 3.5-3.5v-9A3.5 3.5 0 0 0 16.5 4h-9z" />
                        <path d="M12 7a5 5 0 1 1 0 10 5 5 0 0 1 0-10zm0 2a3 3 0 1 0 0 6 3 3 0 0 0 0-6z" />
                        <path d="M17.8 6.2a1 1 0 1 1-2 0 1 1 0 0 1 2 0z" />
                    </svg>
                </a>
            </div>

            <div class="quoteBox" aria-label="Quote">
                <div class="quoteCard">
                    <div class="quoteText">
                        <span class="quoteMark">"</span>Concentrate all your thoughts on the work at hand.
                        The sun's rays do not burn until brought to a focus.<span class="quoteMark">"</span>
                    </div>
                </div>
            </div>

            <div class="railFooter">
                <span id="status">Selected: Location</span>
                <span class="pill">Premium UI</span>
            </div>
        </aside>

        <main class="main">
            <div class="wrap">
                <section class="card" aria-label="Content">
                    <div class="cardHeader">
                        <h2 id="contentTitle">Location</h2>
                        <span class="pill">Active</span>
                    </div>
                    <div id="contentBody" class="small muted"></div>
                </section>

                <section class="card summaryCard" aria-label="Summary">
                    <div class="cardHeader">
                        <h2>Summary</h2>
                        <div class="btnRow">
                            <button class="linkBtn" id="copySummaryBtn" type="button">Copy</button>
                        </div>
                    </div>

                    <div class="summarySticky">
                        <div>
                            <div class="sumLabel">Notes</div>
                            <textarea id="noteBox" class="textarea"
                                placeholder="Type notes here, stays visible."></textarea>
                        </div>

                        <div>
                            <div class="sumLabel">Auto Summary (editable)</div>
                            <textarea id="autoSummaryBox" class="textarea"
                                placeholder="This will auto-fill based on selections, and you can edit it."></textarea>
                            <div class="small muted" id="autoSummaryHint">Auto updates unless you edit it.</div>
                        </div>
                    </div>

                    <div class="summaryScroll">
                        <div class="summaryList" id="summaryList"></div>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <script>
        /* THEME TOGGLE */
        const themeToggle = document.getElementById("themeToggle");
        const themeIcon = document.getElementById("themeIcon");
        const themeText = document.getElementById("themeText");

        function applyTheme(theme) {
            document.documentElement.dataset.theme = theme;
            localStorage.setItem("theme", theme);
            const isLight = theme === "light";
            themeIcon.textContent = isLight ? "☀" : "☾";
            themeText.textContent = isLight ? "Light" : "Dark";
        }

        const savedTheme = localStorage.getItem("theme");
        applyTheme(savedTheme === "light" ? "light" : "dark");

        themeToggle.addEventListener("click", () => {
            const now = document.documentElement.dataset.theme === "light" ? "dark" : "light";
            applyTheme(now);
        });

        /* APP LOGIC */
        const nav = document.getElementById("nav");
        const status = document.getElementById("status");
        const contentTitle = document.getElementById("contentTitle");
        const contentBody = document.getElementById("contentBody");
        const summaryList = document.getElementById("summaryList");

        const noteBox = document.getElementById("noteBox");
        const autoSummaryBox = document.getElementById("autoSummaryBox");
        const autoSummaryHint = document.getElementById("autoSummaryHint");
        const copySummaryBtn = document.getElementById("copySummaryBtn");

        const state = {
            activeSection: "Location",

            /* Location */
            locationStage: "",
            stillMoving: "",
            cityAreas: "",
            communities: "",
            irvineAppeal: "",
            searchScope: "", // "Only in specific city" | "Open to few areas"
            searchReason: "",

            neighborhood: { values: [], locked: false },
            homeType: { values: [], locked: false },
            bedroom: { values: [], locked: false },
            bathroom: { values: [], locked: false },

            /* Price */
            priceMinBase: 400, // always selected
            priceMaxBase: 450, // can be cleared
            priceMinAdds: [],
            priceMaxAdds: [],

            /* Motivation */
            motivation: { values: [], locked: false },

            /* Agent */
            hasBroker: { value: "", locked: false },

            /* Mortgage */
            payType: { values: [], locked: false },
            preApproved: { value: "", locked: false },

            /* Appointment */
            apptDate: "",
            apptTime: "",
            apptType: "",

            /* Summary text control */
            notes: "",
            autoSummaryDirty: false,
            lastAutoSummary: ""
        };

        const ADD_OPTIONS = [50, 100, 200, 300, 400, 500, 600, 700, 800, 900, 1000];

        function escapeHtml(str) {
            return String(str)
                .replaceAll("&", "&amp;")
                .replaceAll("<", "&lt;")
                .replaceAll(">", "&gt;")
                .replaceAll('"', "&quot;")
                .replaceAll("'", "&#039;");
        }

        function joinList(arr) {
            if (!arr || !arr.length) return "";
            return arr.join(", ");
        }

        function formatMoney(n) {
            if (n === null || n === undefined || n === "") return "";
            const num = Number(n);
            if (Number.isNaN(num)) return "";
            return "$" + num.toLocaleString("en-US");
        }

        function sum(arr) {
            return (arr || []).reduce((a, b) => a + Number(b || 0), 0);
        }

        function computeMinTotal() {
            return Number(state.priceMinBase || 0) + sum(state.priceMinAdds);
        }

        function computeMaxTotal() {
            if (state.priceMaxBase === null) return null; // not set, even if chips exist
            return Number(state.priceMaxBase || 0) + sum(state.priceMaxAdds);
        }

        function formatTime12hFromHHMM(hhmm) {
            if (!hhmm || !hhmm.includes(":")) return "";
            const [hhStr, mmStr] = hhmm.split(":");
            let hh = parseInt(hhStr, 10);
            const mm = parseInt(mmStr, 10);
            if (Number.isNaN(hh) || Number.isNaN(mm)) return "";
            const ampm = hh >= 12 ? "PM" : "AM";
            let h12 = hh % 12;
            if (h12 === 0) h12 = 12;
            if (mm === 0) return `${h12}${ampm}`;
            return `${h12}:${String(mm).padStart(2, "0")}${ampm}`;
        }

        function todayISO() {
            const d = new Date();
            const yyyy = d.getFullYear();
            const mm = String(d.getMonth() + 1).padStart(2, "0");
            const dd = String(d.getDate()).padStart(2, "0");
            return `${yyyy}-${mm}-${dd}`;
        }

        function buildAutoSummaryText() {
            const lines = [];

            if (state.locationStage) lines.push(`Stage: ${state.locationStage}`);
            if (state.stillMoving) lines.push(`Still thinking about moving: ${state.stillMoving}`);
            if (state.cityAreas.trim()) lines.push(`City or areas: ${state.cityAreas.trim()}`);
            if (state.searchScope) lines.push(`Search scope: ${state.searchScope}`);
            if (state.searchReason) lines.push(`Reason: ${state.searchReason}`);

            const n = joinList(state.neighborhood.values);
            const h = joinList(state.homeType.values);
            const b = joinList(state.bedroom.values);
            const ba = joinList(state.bathroom.values);
            if (n) lines.push(`Neighborhood: ${n}`);
            if (h) lines.push(`Home type: ${h}`);
            if (b) lines.push(`Bedrooms: ${b}`);
            if (ba) lines.push(`Bathrooms: ${ba}`);

            const minTotal = computeMinTotal();
            const maxTotal = computeMaxTotal();
            if (maxTotal === null) {
                lines.push(`Price range: ${formatMoney(minTotal)}`);
            } else {
                lines.push(`Price range: Min ${formatMoney(minTotal)} - Max ${formatMoney(maxTotal)}`);
            }

            if (state.motivation.values.length) lines.push(`Motivation: ${joinList(state.motivation.values)}`);
            if (state.hasBroker.value) lines.push(`Already with a broker: ${state.hasBroker.value}`);
            if (state.payType.values.length) lines.push(`Paying: ${joinList(state.payType.values)}`);
            if (state.preApproved.value) lines.push(`Pre-approved: ${state.preApproved.value}`);

            if (state.apptType) lines.push(`Appointment type: ${state.apptType}`);
            if (state.apptDate) lines.push(`Appointment date: ${state.apptDate}`);
            if (state.apptTime) lines.push(`Appointment time: ${formatTime12hFromHHMM(state.apptTime)}`);

            if (!lines.length) return "No selections yet. Start with Location.";
            return lines.join("\n");
        }

        function syncAutoSummary() {
            const autoText = buildAutoSummaryText();
            const current = autoSummaryBox.value || "";
            const safeToReplace = (!state.autoSummaryDirty) || (current === state.lastAutoSummary) || (current.trim() === "");

            if (safeToReplace) {
                autoSummaryBox.value = autoText;
                state.lastAutoSummary = autoText;
                state.autoSummaryDirty = false;
                autoSummaryHint.textContent = "Auto updates unless you edit it.";
            } else {
                autoSummaryHint.textContent = "You edited this. It will not auto-overwrite.";
            }
        }

        function renderSummary() {
            const rows = [];

            if (state.locationStage) rows.push({ label: "Stage", value: state.locationStage });
            if (state.stillMoving) rows.push({ label: "Still thinking about moving", value: state.stillMoving });
            if (state.cityAreas.trim()) rows.push({ label: "City or areas", value: state.cityAreas.trim() });
            if (state.searchScope) rows.push({ label: "Search scope", value: state.searchScope });
            if (state.searchReason) rows.push({ label: "Reason", value: state.searchReason });

            const n = joinList(state.neighborhood.values);
            const h = joinList(state.homeType.values);
            const b = joinList(state.bedroom.values);
            const ba = joinList(state.bathroom.values);

            if (n) rows.push({ label: "Neighborhood priority", value: n });
            if (h) rows.push({ label: "Home type", value: h });
            if (b) rows.push({ label: "Bedrooms", value: b });
            if (ba) rows.push({ label: "Bathrooms", value: ba });

            const minTotal = computeMinTotal();
            const maxTotal = computeMaxTotal();

            if (maxTotal === null) {
                rows.push({ label: "Price range", value: formatMoney(minTotal) });
            } else {
                rows.push({ label: "Price range", value: `Min ${formatMoney(minTotal)} - Max ${formatMoney(maxTotal)}` });
            }

            if (state.motivation.values.length) rows.push({ label: "Motivation", value: joinList(state.motivation.values) });
            if (state.hasBroker.value) rows.push({ label: "Already with a broker", value: state.hasBroker.value });

            const pt = joinList(state.payType.values);
            if (pt) rows.push({ label: "Paying", value: pt });
            if (state.preApproved.value) rows.push({ label: "Pre-approved", value: state.preApproved.value });

            if (state.apptType) rows.push({ label: "Appointment type", value: state.apptType });
            if (state.apptDate) rows.push({ label: "Appointment date", value: state.apptDate });
            if (state.apptTime) rows.push({ label: "Appointment time", value: formatTime12hFromHHMM(state.apptTime) });

            if (!rows.length) rows.push({ label: "Summary", value: "No selections yet. Start with Location." });

            summaryList.innerHTML = rows.map(r => `
        <div class="sumRow">
          <div class="sumLabel">${escapeHtml(r.label)}</div>
          <div class="sumValue">${escapeHtml(r.value)}</div>
        </div>
      `).join("");

            syncAutoSummary();
        }

        function toggleInArray(arr, value, checked) {
            const set = new Set(arr);
            if (checked) set.add(value);
            else set.delete(value);
            return [...set];
        }

        function chipGroupMultiHTML({ groupId, title, options, locked, selectedValues }) {
            const chips = options.map((opt) => {
                const selected = selectedValues.includes(opt);
                const hidden = locked && !selected;
                return `
          <label class="chip ${selected ? "selected" : ""}" style="${hidden ? "display:none" : ""}">
            <input type="checkbox"
              value="${escapeHtml(opt)}"
              data-group="${escapeHtml(groupId)}"
              ${selected ? "checked" : ""}>
            <span class="box" aria-hidden="true">${selected ? "✓" : ""}</span>
            <span>${escapeHtml(opt)}</span>
          </label>
        `;
            }).join("");

            const hasAny = selectedValues.length > 0;

            return `
        <div class="section" id="${escapeHtml(groupId)}">
          <p class="sectionTitle">${escapeHtml(title)}</p>
          <div class="choices">${chips}</div>
          <div class="lockRow">
            <span class="small muted">
              ${locked ? "Locked, unticked options are hidden." : "Select one or more, then Lock to hide unticked options."}
            </span>
            <div class="btnRow">
              <button class="linkBtn" type="button" data-action="lock" data-group="${escapeHtml(groupId)}" style="${(!locked && hasAny) ? "" : "display:none"}">Lock</button>
              <button class="linkBtn" type="button" data-action="unlock" data-group="${escapeHtml(groupId)}" style="${locked ? "" : "display:none"}">Change</button>
              <button class="linkBtn" type="button" data-action="clear" data-group="${escapeHtml(groupId)}" style="${(!locked && hasAny) ? "" : "display:none"}">Clear</button>
            </div>
          </div>
        </div>
      `;
        }

        function reasonScripts(reason) {
            const scripts = {
                "Tired of Renting (Path to Equity)": [
                    "I completely hear you. Transitioning from paying a landlord’s mortgage to building your own equity is one of the smartest financial moves you can make. Focusing on [City] is a great choice; it has a historically stable market that will turn those monthly payments into a long-term asset.",
                    "I hear you. Rent can feel like a dead end when it keeps going up and you are not building anything. The good news is we can check if owning makes sense for you right now, based on your monthly budget and timeline."
                ],
                "Proximity to Work (Time Wealth)": [
                    "That's such an exciting milestone, finding the right home before school starts makes total sense.",
                    "Efficiency is the ultimate luxury. Shortening your commute isn't just about gas prices, it’s about getting your mornings and evenings back. We’ll focus on neighborhoods that give you the quickest door-to-desk time."
                ],
                "Job Relocation (Seamless Transition)": [
                    "Congratulations on the new role! Relocating is a whirlwind and can be hectic, so I’ll handle the heavy lifting on the ground here in [City]. My goal is to find you a home that makes this transition feel less like a move and more like a promotion. Let’s keep this simple and narrow the search fast."
                ],
                "Growing Family (The 'Next Chapter' Home)": [
                    "Wonderful! That is such an exciting milestone. When you’re expecting a new addition or bringing the extended family under one roof, the 'flow' of a house becomes everything."
                ],
                "Lifestyle Upgrade (High-End Refinement)": [
                    "You’ve worked hard to get to this point, and your home should reflect that. We’ll look for properties that offer that 'wow' factor and the specific high-end finishes you’re looking for."
                ],
                "Investment-Minded Buyer (The Asset Play)": [
                    "It’s great to work with someone who sees the 'big picture' value! [City] is a smart play right now, there are certain neighborhoods there that are really starting to take off. I’ll pull together the latest data and some 'under-the-radar' info on what’s being built nearby. We’ll make sure that wherever you put your money, it’s going to work hard for you over the next decade.",
                    "I’m right there with you, I love a data-driven search. [City] is showing some really strong potential for appreciation and solid rental yields at the moment. I’ll get to work on the 'comps' and local development maps so we can be sure this location aligns with your 5-to-10-year goals. Let’s make sure this is a win for your portfolio as much as it is for your lifestyle."
                ],
                "Education/Schools (Future-Proofing)": [
                    "I understand completely, often, the school district is more important than the house itself. By targeting [City] for its educational reputation, you aren't just buying a home; you're securing an environment for your children and protecting your resale value. I’ll filter our search specifically within those top-tier school boundaries.",
                    "That's such an exciting milestone, finding the right home before school starts makes total sense."
                ]
            };
            return scripts[reason] || [];
        }

        function renderLocation() {
            const stageMove = (state.locationStage === "Move soon");
            const stageBrowse = (state.locationStage === "Browsing stage");

            const yesMove = state.stillMoving === "Yes";
            const noMove = state.stillMoving === "No";

            const scopeSpecific = state.searchScope === "Only in specific city";
            const scopeOpen = state.searchScope === "Open to few areas";

            const reasonOptions = [
                "Tired of Renting (Path to Equity)",
                "Proximity to Work (Time Wealth)",
                "Job Relocation (Seamless Transition)",
                "Growing Family (The 'Next Chapter' Home)",
                "Lifestyle Upgrade (High-End Refinement)",
                "Investment-Minded Buyer (The Asset Play)",
                "Education/Schools (Future-Proofing)"
            ];

            const scopeScript = scopeOpen
                ? "That is actually music to my ears! Being open to a few different spots gives us so much more room to find you something truly special. It’s often the best way to get more 'bang for your buck' or find a hidden gem we might have missed otherwise."
                : "";

            const reasonLines = reasonScripts(state.searchReason);

            const stageQuestionLine = "Are you looking to move soon, or are you still in the early browsing stage?";

            const browseTopScript = "I am glad that you are upfront about it. Even if you're not ready to move immediately, understanding your options now can help you make better decisions when you are ready. What specifically are you hoping to find out while you're browsing?";
            const moveTopScript = "Great, I love working with motivated people. First, let me ask a few key questions to find you a perfect home.";

            return `
        <div class="section" style="border-top:none; padding-top:0; margin-top:0;">
          <div class="scriptBox">
            Hi [Name], this is Adrian with Power Real Estate Group. I’m calling because you inquired about purchasing a home?
            <br><br>
            Or I saw you were checking out a few homes in [area], and I wanted to personally reach out. Don’t worry, I’m not calling to pressure you or sell you anything today.
            <br><br>
            I just want to make sure you’re actually finding what you’re looking for… or if the “perfect home” is playing hard to get. Are you still thinking about making a move?
          </div>

          <div class="q" style="margin-top:12px;">
            <div class="qIcon" aria-hidden="true">○</div>
            <div class="qBody">
              <p class="qText">Still thinking about making a move?</p>
              <div class="choices">
                <label class="chip ${yesMove ? "selected" : ""}">
                  <input type="radio" name="stillMoving" value="Yes" data-action="stillMoving" ${yesMove ? "checked" : ""}>
                  <span class="box" aria-hidden="true">${yesMove ? "✓" : ""}</span>
                  <span>Yes</span>
                </label>
                <label class="chip ${noMove ? "selected" : ""}">
                  <input type="radio" name="stillMoving" value="No" data-action="stillMoving" ${noMove ? "checked" : ""}>
                  <span class="box" aria-hidden="true">${noMove ? "✓" : ""}</span>
                  <span>No</span>
                </label>
              </div>

              ${yesMove ? `
                <div class="section" style="border-top:none; padding-top:0; margin-top:10px;">
                  <div class="scriptBox">
                    That's great to hear! I'd love to help make this easier for you. My role is simple: understand what you want, make sure you’re positioned correctly, and connect you with the right strategy so you’re not just browsing… you’re moving intentionally. Let's make this quick. Sound fair?
                  </div>
                </div>
              ` : ``}

              ${noMove ? `
                <div class="section" style="border-top:none; padding-top:0; margin-top:10px;">
                  <div class="scriptBox">
                    That makes sense; life has a way of shifting priorities! If anything changes or you'd like insight into the market later, or if you ever want a quick market update or have questions about home values in [area], I'm always happy to help, even if you're not actively looking. Please feel free to reach out, and I'm here to help, no pressure. Wishing you all the best!
                    <br><br>
                    No worries. What has changed since then? When are you considering getting back into the market? Is there any other information I can get for you?
                  </div>
                </div>
              ` : ``}
            </div>
          </div>

          <div class="q">
            <div class="qIcon" aria-hidden="true">○</div>
            <div class="qBody">
              <p class="qText">Select stage</p>
              <div class="choices">
                <label class="chip ${stageMove ? "selected" : ""}">
                  <input type="radio" name="stage" value="Move soon" data-action="stage" ${stageMove ? "checked" : ""}>
                  <span class="box" aria-hidden="true">${stageMove ? "✓" : ""}</span>
                  <span>Move soon</span>
                </label>
                <label class="chip ${stageBrowse ? "selected" : ""}">
                  <input type="radio" name="stage" value="Browsing stage" data-action="stage" ${stageBrowse ? "checked" : ""}>
                  <span class="box" aria-hidden="true">${stageBrowse ? "✓" : ""}</span>
                  <span>Browsing stage</span>
                </label>
              </div>

              <div class="section" style="border-top:none; padding-top:0; margin-top:10px;">
                <div class="scriptBox">${escapeHtml(stageQuestionLine)}</div>
              </div>
            </div>
          </div>

          ${state.locationStage ? `
            <div class="section" id="locationQuestions">
              <div class="scriptBox">
                ${escapeHtml(stageMove ? moveTopScript : browseTopScript)}
              </div>

              <div class="q" style="margin-top:12px;">
                <div class="qIcon" aria-hidden="true">✓</div>
                <div class="qBody">
                  <p class="qText">1. Are you looking in a specific city, or are you open to a few different areas?</p>
                  <input class="input" data-field="cityAreas" placeholder="Type answer here" value="${escapeHtml(state.cityAreas)}" />

                  <div class="choices" style="margin-top:10px;">
                    <label class="chip ${scopeSpecific ? "selected" : ""}">
                      <input type="radio" name="scope" value="Only in specific city" data-action="scope" ${scopeSpecific ? "checked" : ""}>
                      <span class="box" aria-hidden="true">${scopeSpecific ? "✓" : ""}</span>
                      <span>Only in specific city</span>
                    </label>
                    <label class="chip ${scopeOpen ? "selected" : ""}">
                      <input type="radio" name="scope" value="Open to few areas" data-action="scope" ${scopeOpen ? "checked" : ""}>
                      <span class="box" aria-hidden="true">${scopeOpen ? "✓" : ""}</span>
                      <span>Open to few areas</span>
                    </label>
                  </div>

                  ${scopeOpen ? `
                    <div class="section" style="border-top:none; padding-top:0; margin-top:10px;">
                      <div class="scriptBox">${escapeHtml(scopeScript)}</div>
                    </div>
                  ` : ``}

                  ${(scopeSpecific || scopeOpen) ? `
                    <div class="section">
                      <p class="sectionTitle">What’s driving the focus?</p>
                      <div class="choices">
                        ${reasonOptions.map(opt => {
                const selected = state.searchReason === opt;
                return `
                            <label class="chip ${selected ? "selected" : ""}">
                              <input type="radio" name="reason" value="${escapeHtml(opt)}" data-action="reason" ${selected ? "checked" : ""}>
                              <span class="box" aria-hidden="true">${selected ? "✓" : ""}</span>
                              <span>${escapeHtml(opt)}</span>
                            </label>
                          `;
            }).join("")}
                      </div>

                      ${state.searchReason ? `
                        <div class="section">
                          <div class="scriptBox">
                            ${reasonLines.map(line => escapeHtml(line)).join("<br><br>")}
                          </div>
                        </div>
                      ` : ``}
                    </div>
                  ` : ``}
                </div>
              </div>

              <div class="q">
                <div class="qIcon" aria-hidden="true">✓</div>
                <div class="qBody">
                  <p class="qText">2. Have you narrowed it down to particular communities?</p>
                  <input class="input" data-field="communities" placeholder="Type communities here" value="${escapeHtml(state.communities)}" />
                </div>
              </div>

              <div class="q">
                <div class="qIcon" aria-hidden="true">✓</div>
                <div class="qBody">
                  <p class="qText">3. What specifically about Irvine appeals to you most?</p>
                  <input class="input" data-field="irvineAppeal" placeholder="Type what appeals most" value="${escapeHtml(state.irvineAppeal)}" />
                </div>
              </div>

              <div class="q">
                <div class="qIcon" aria-hidden="true">✓</div>
                <div class="qBody">
                  <p class="qText">4. What's most important to you in a neighborhood?</p>
                  ${chipGroupMultiHTML({
                groupId: "neighborhoodGroup",
                title: "Neighborhood preference",
                options: ["Residential", "Quiet", "Central", "With spacious parking", "Near Home", "Easy to commute", "School", "Near workplace"],
                locked: state.neighborhood.locked,
                selectedValues: state.neighborhood.values
            })}
                </div>
              </div>

              <div class="q">
                <div class="qIcon" aria-hidden="true">•</div>
                <div class="qBody">
                  <p class="qText">Ideal home, how many bedrooms and bathrooms?</p>

                  ${chipGroupMultiHTML({
                groupId: "homeTypeGroup",
                title: "HOME category",
                options: ["Single-family house", "Townhouse", "Duplex (2 units)", "Triplex / Fourplex", "Condo", "Studio unit, single open space"],
                locked: state.homeType.locked,
                selectedValues: state.homeType.values
            })}

                  ${chipGroupMultiHTML({
                groupId: "bedroomGroup",
                title: "Bedroom category",
                options: ["1 bedroom", "2 bedrooms", "3 bedrooms", "4 bedrooms", "5 bedrooms"],
                locked: state.bedroom.locked,
                selectedValues: state.bedroom.values
            })}

                  ${chipGroupMultiHTML({
                groupId: "bathroomGroup",
                title: "Bathroom category",
                options: ["1 bathroom", "1.5 bathroom", "2 bathrooms", "2.5 bathrooms", "3 bathrooms"],
                locked: state.bathroom.locked,
                selectedValues: state.bathroom.values
            })}
                </div>
              </div>
            </div>
          ` : `
            <div class="section">
              <div class="scriptBox small muted">Select Move soon or Browsing stage to continue.</div>
            </div>
          `}
        </div>
      `;
        }

        function renderPrice() {
            const minTotal = computeMinTotal();
            const maxTotal = computeMaxTotal();

            const minSelected = state.priceMinBase;
            const maxSelected = state.priceMaxBase;

            const maxLabel = (maxSelected === null) ? "Not set" : formatMoney(maxTotal);

            function baseChip(name, value, selected, dataAction, canUncheck) {
                return `
          <label class="chip ${selected ? "selected" : ""}">
            <input type="${canUncheck ? "checkbox" : "radio"}"
              name="${escapeHtml(name)}"
              value="${escapeHtml(String(value))}"
              data-action="${escapeHtml(dataAction)}"
              ${selected ? "checked" : ""}>
            <span class="box" aria-hidden="true">${selected ? "✓" : ""}</span>
            <span>${escapeHtml(formatMoney(value))}</span>
          </label>
        `;
            }

            function addButtonsHTML(which) {
                return `
          <div class="plusRow">
            ${ADD_OPTIONS.map(v => `
              <button class="addBtn" type="button" data-action="addPlus" data-which="${which}" data-val="${v}">
                +${v === 1000 ? "1K" : v}
              </button>
            `).join("")}
          </div>
        `;
            }

            function tokenHTML(which, arr) {
                if (!arr.length) return `<div class="small muted" style="margin-top:8px;">No add-ons yet.</div>`;
                return `
          <div class="tokenRow">
            ${arr.map((v, idx) => `
              <div class="token" role="button" tabindex="0"
                data-action="removePlus" data-which="${which}" data-idx="${idx}"
                title="Click to remove">
                <span>+${v === 1000 ? "1K" : v}</span>
                <span class="x">×</span>
              </div>
            `).join("")}
          </div>
        `;
            }

            return `
        <div class="section" style="border-top:none; padding-top:0; margin-top:0;">
          <div class="scriptBox">
            What would you say is your comfortable number, and what’s your absolute top-end if the home is perfect?
          </div>

          <div class="section">
            <div class="miniBox">
              <div class="fieldRow">
                <div>
                  <div class="miniTitle">Min base (always selected)</div>
                  <div class="choices">
                    ${baseChip("minBase", 400, minSelected === 400, "minBase", false)}
                    ${baseChip("minBase", 500, minSelected === 500, "minBase", false)}
                    ${baseChip("minBase", 600, minSelected === 600, "minBase", false)}
                  </div>
                  <div class="miniTitle" style="margin-top:10px;">Min add-ons</div>
                  ${addButtonsHTML("min")}
                  ${tokenHTML("min", state.priceMinAdds)}
                  <div class="miniTitle" style="margin-top:10px;">Min total</div>
                  <div class="miniValue">${escapeHtml(formatMoney(minTotal))}</div>
                </div>

                <div>
                  <div class="miniTitle">Max base (optional)</div>
                  <div class="choices">
                    ${baseChip("maxBase", 450, maxSelected === 450, "maxBase", true)}
                    ${baseChip("maxBase", 600, maxSelected === 600, "maxBase", true)}
                    ${baseChip("maxBase", 650, maxSelected === 650, "maxBase", true)}
                    <button class="linkBtn" type="button" data-action="clearMaxBase" style="margin-left:2px;">Clear</button>
                  </div>
                  <div class="miniTitle" style="margin-top:10px;">Max add-ons (allowed even if Max base is cleared)</div>
                  ${addButtonsHTML("max")}
                  ${tokenHTML("max", state.priceMaxAdds)}
                  <div class="miniTitle" style="margin-top:10px;">Max total</div>
                  <div class="miniValue">${escapeHtml(maxLabel)}</div>
                </div>
              </div>
            </div>

            <div class="pickerHint">
              Tip: Click + buttons to add again, click a selected add-on pill to remove and subtract.
            </div>
          </div>
        </div>
      `;
        }

        function motivationDetails(reason) {
            const map = {
                "Job Change or Relocation": ["Got it. So a job change bringing you to area. That makes sense."],
                "Growing Family": [
                    "Got it. With a growing family, space and layout matter more than anything.",
                    "Makes sense. For a growing family, safety and a kid friendly community are key."
                ],
                "School": ["That's such an exciting milestone, finding the right home before school starts makes total sense."],
                "Lifestyle Upgrade": [
                    "Got it. When you say lifestyle upgrade, what changes in your daily routine, shorter commute, better walkability, quieter space, or better amenities like a gym and pool?",
                    "Love that, lifestyle upgrade is a smart goal. Let’s define what that looks like so I can filter properly."
                ],
                "Equity Builder": [
                    "I hear you. Rent can feel like a dead end when it keeps going up and you are not building anything. The good news is we can check if owning makes sense for you right now, based on your monthly budget and timeline."
                ],
                "Investment-Minded Buyer": [
                    "Understood. What return do you consider a win, steady rental income, or higher growth even if rent is lower? I’ll shortlist properties that match that."
                ],
                "Timing Uncertain": [
                    "That’s completely fine. You don’t need to be sure today. My role is to help you get clarity, not to push you.",
                    "What are you unsure about most, budget, location, timing, or whether buying is the right move?",
                    "No problem. We can do this two ways, we either start with a quick budget and financing check, or we start with viewing a few options so you can see what your money gets. I’ll guide you either way.",
                    "To help you decide, tell me what would make you feel confident, a monthly payment number, a commute time, or the right type of home?"
                ],
            };
            const lines = map[reason] || [];
            if (!lines.length) return "";
            return `
        <div class="section">
          <p class="sectionTitle">${escapeHtml(reason)} section</p>
          ${lines.map(line => `
            <div class="q">
              <div class="qIcon" aria-hidden="true">•</div>
              <div class="qBody">
                <p class="qText" style="margin-bottom:0;">${escapeHtml(line)}</p>
              </div>
            </div>
          `).join("")}
        </div>
      `;
        }

        function renderMotivation() {
            const options = ["Job Change or Relocation", "Growing Family", "School", "Lifestyle Upgrade", "Equity Builder", "Investment-Minded Buyer", "Timing Uncertain"];
            const selected = state.motivation.values;

            return `
        <div class="section" style="border-top:none; padding-top:0; margin-top:0;">
          <div class="scriptBox">So what's got you thinking about making a move right now?</div>

          ${chipGroupMultiHTML({
                groupId: "motivationGroup",
                title: "Select motivation(s)",
                options,
                locked: state.motivation.locked,
                selectedValues: selected
            })}

          ${selected.length ? `
            <div class="section" id="motivationDetails">
              <p class="sectionTitle">Selected sections</p>
              ${selected.map(m => motivationDetails(m)).join("")}
            </div>
          ` : `
            <div class="section">
              <div class="scriptBox small muted">Pick one or more motivations, they appear in Summary and expand below.</div>
            </div>
          `}
        </div>
      `;
        }

        function renderAgent() {
            const yes = state.hasBroker.value === "Yes";
            const no = state.hasBroker.value === "No";
            const locked = state.hasBroker.locked;
            const hideOther = locked && state.hasBroker.value;

            function chip(label) {
                const selected = state.hasBroker.value === label;
                const hidden = hideOther && !selected;
                return `
          <label class="chip ${selected ? "selected" : ""}" style="${hidden ? "display:none" : ""}">
            <input type="checkbox" value="${label}" data-group="agentGroup" ${selected ? "checked" : ""}>
            <span class="box" aria-hidden="true">${selected ? "✓" : ""}</span>
            <span>${label}</span>
          </label>
        `;
            }

            return `
        <div class="section" style="border-top:none; padding-top:0; margin-top:0;">
          <div class="q">
            <div class="qIcon" aria-hidden="true">•</div>
            <div class="qBody">
              <p class="qText">Just to avoid stepping on anyone’s toes, have you already been speaking with a broker about this search?</p>
              <div class="choices">${chip("No")}${chip("Yes")}</div>

              <div class="lockRow">
                <span class="small muted">${locked ? "Selected and locked. Other option is hidden." : "Pick one. It will hide the other option and update Summary."}</span>
                <div class="btnRow">
                  <button class="linkBtn" type="button" data-action="unlock" data-group="agentGroup" style="${locked ? "" : "display:none"}">Change</button>
                  <button class="linkBtn" type="button" data-action="clear" data-group="agentGroup" style="${(!locked && state.hasBroker.value) ? "" : "display:none"}">Clear</button>
                </div>
              </div>
            </div>
          </div>

          ${yes ? `
            <div class="q">
              <div class="qIcon" aria-hidden="true">•</div>
              <div class="qBody">
                <p class="qText" style="margin-bottom:0;">
                  Perfect, thanks for letting me know. If you have an exclusive agreement, I’ll step back and won’t interfere. If you’re not exclusive and you just want a second opinion on pricing or options, I can help with that.
                </p>
              </div>
            </div>
          ` : ``}

          ${no ? `
            <div class="q">
              <div class="qIcon" aria-hidden="true">•</div>
              <div class="qBody">
                <p class="qText" style="margin-bottom:0;">
                  Great, then I’ll take care of the filtering for you. I’ll send a short list that matches your budget and location, and include the key details people usually miss like dues, parking, and realistic pricing.
                </p>
              </div>
            </div>
          ` : ``}
        </div>
      `;
        }

        function renderMortgage() {
            const no = state.preApproved.value === "No";
            const locked = state.preApproved.locked;
            const hideOther = locked && state.preApproved.value;

            function yesNoChip(label) {
                const selected = state.preApproved.value === label;
                const hidden = hideOther && !selected;
                return `
          <label class="chip ${selected ? "selected" : ""}" style="${hidden ? "display:none" : ""}">
            <input type="checkbox" value="${label}" data-group="preApprovedGroup" ${selected ? "checked" : ""}>
            <span class="box" aria-hidden="true">${selected ? "✓" : ""}</span>
            <span>${label}</span>
          </label>
        `;
            }

            return `
        <div class="section" style="border-top:none; padding-top:0; margin-top:0;">
          <div class="q">
            <div class="qIcon" aria-hidden="true">•</div>
            <div class="qBody">
              <p class="qText">Just want to make sure I'm showing you homes that fit your budget. And are you paying cash or financing?</p>

              ${chipGroupMultiHTML({
                groupId: "payTypeGroup",
                title: "Cash or financing",
                options: ["Cash", "Financing"],
                locked: state.payType.locked,
                selectedValues: state.payType.values
            })}
            </div>
          </div>

          <div class="q">
            <div class="qIcon" aria-hidden="true">•</div>
            <div class="qBody">
              <p class="qText">Have you had a chance to get pre-approved yet?</p>

              <div class="choices">
                ${yesNoChip("Yes")}
                ${yesNoChip("No")}
              </div>

              <div class="lockRow">
                <span class="small muted">${locked ? "Selected and locked. Other option is hidden." : "Pick one. It will hide the other option and update Summary."}</span>
                <div class="btnRow">
                  <button class="linkBtn" type="button" data-action="unlock" data-group="preApprovedGroup" style="${locked ? "" : "display:none"}">Change</button>
                  <button class="linkBtn" type="button" data-action="clear" data-group="preApprovedGroup" style="${(!locked && state.preApproved.value) ? "" : "display:none"}">Clear</button>
                </div>
              </div>

              ${no ? `
                <div class="section" style="border-top:none; padding-top:0; margin-top:10px;">
                  <div class="scriptBox">
                    That's actually the perfect first step! Getting pre-approved tells you exactly what you qualify for and puts you ahead of other buyers.
                    We work with some excellent lenders who can get that done quickly and show you all available programs, including options with as little as 3-5% down, and some buyers even qualify for 0% down programs.
                    Getting pre-approved before you start seriously looking is huge in this market.
                  </div>
                </div>
              ` : ``}
            </div>
          </div>
        </div>
      `;
        }

        function renderAppointment() {
            const minDate = todayISO();

            const inPerson = state.apptType === "In-Person";
            const zoom = state.apptType === "Online (Zoom)";
            const meet = state.apptType === "Online (Google Meet)";
            const phone = state.apptType === "Phone call";

            return `
        <div class="section" style="border-top:none; padding-top:0; margin-top:0;">
          <div class="q">
            <div class="qIcon" aria-hidden="true">•</div>
            <div class="qBody">
              <p class="qText">Appointment type</p>
              <div class="choices">
                <label class="chip ${inPerson ? "selected" : ""}">
                  <input type="radio" name="apptType" value="In-Person" data-action="apptType" ${inPerson ? "checked" : ""}>
                  <span class="box" aria-hidden="true">${inPerson ? "✓" : ""}</span>
                  <span>In-Person</span>
                </label>
                <label class="chip ${zoom ? "selected" : ""}">
                  <input type="radio" name="apptType" value="Online (Zoom)" data-action="apptType" ${zoom ? "checked" : ""}>
                  <span class="box" aria-hidden="true">${zoom ? "✓" : ""}</span>
                  <span>Online (Zoom)</span>
                </label>
                <label class="chip ${meet ? "selected" : ""}">
                  <input type="radio" name="apptType" value="Online (Google Meet)" data-action="apptType" ${meet ? "checked" : ""}>
                  <span class="box" aria-hidden="true">${meet ? "✓" : ""}</span>
                  <span>Online (Google Meet)</span>
                </label>
                <label class="chip ${phone ? "selected" : ""}">
                  <input type="radio" name="apptType" value="Phone call" data-action="apptType" ${phone ? "checked" : ""}>
                  <span class="box" aria-hidden="true">${phone ? "✓" : ""}</span>
                  <span>Phone call</span>
                </label>
              </div>
            </div>
          </div>

          <div class="q">
            <div class="qIcon" aria-hidden="true">📅</div>
            <div class="qBody">
              <p class="qText">Select date and time</p>

              <div class="fieldRow">
                <div>
                  <div class="sumLabel">Date (future only)</div>
                  <div class="pickerBox" data-action="focusPicker" data-target="apptDateInput">
                    <input id="apptDateInput" type="date" min="${minDate}" value="${escapeHtml(state.apptDate || "")}" />
                  </div>
                  <div class="pickerHint">You can click anywhere in the box, pick from calendar, or type.</div>
                </div>

                <div>
                  <div class="sumLabel">Time</div>
                  <div class="pickerBox" data-action="focusPicker" data-target="apptTimeInput">
                    <input id="apptTimeInput" type="time" step="1800" value="${escapeHtml(state.apptTime || "")}" />
                  </div>
                  <div class="pickerHint">Editable, and the picker stays available.</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      `;
        }

        function renderPlaceholder(name) {
            return `
        <div class="scriptBox">
          <div style="font-weight:700; margin-bottom:6px;">${escapeHtml(name)} (Coming next)</div>
          <div class="small muted">This section is a placeholder for now.</div>
        </div>
      `;
        }

        function setActiveSection(section) {
            state.activeSection = section;

            [...nav.querySelectorAll(".navbtn")].forEach(btn => {
                btn.classList.toggle("active", btn.dataset.section === section);
            });

            status.textContent = "Selected: " + section;
            contentTitle.textContent = section;

            if (section === "Location") contentBody.innerHTML = renderLocation();
            else if (section === "Price") contentBody.innerHTML = renderPrice();
            else if (section === "Motivation") contentBody.innerHTML = renderMotivation();
            else if (section === "Agent") contentBody.innerHTML = renderAgent();
            else if (section === "Mortgage") contentBody.innerHTML = renderMortgage();
            else if (section === "Appointment") contentBody.innerHTML = renderAppointment();
            else contentBody.innerHTML = renderPlaceholder(section);

            renderSummary();
        }

        nav.addEventListener("click", (e) => {
            const btn = e.target.closest(".navbtn");
            if (!btn) return;
            setActiveSection(btn.dataset.section);
        });

        contentBody.addEventListener("click", (e) => {
            const box = e.target.closest('[data-action="focusPicker"]');
            if (box) {
                const targetId = box.getAttribute("data-target");
                const inp = document.getElementById(targetId);
                if (inp) {
                    inp.focus();
                    if (typeof inp.showPicker === "function") {
                        try { inp.showPicker(); } catch { }
                    }
                }
            }

            const plusBtn = e.target.closest('button[data-action="addPlus"]');
            if (plusBtn) {
                const which = plusBtn.getAttribute("data-which");
                const v = Number(plusBtn.getAttribute("data-val"));
                if (which === "min") state.priceMinAdds.push(v);
                if (which === "max") state.priceMaxAdds.push(v);
                setActiveSection("Price");
                return;
            }

            const token = e.target.closest('[data-action="removePlus"]');
            if (token) {
                const which = token.getAttribute("data-which");
                const idx = Number(token.getAttribute("data-idx"));
                if (which === "min" && idx >= 0 && idx < state.priceMinAdds.length) state.priceMinAdds.splice(idx, 1);
                if (which === "max" && idx >= 0 && idx < state.priceMaxAdds.length) state.priceMaxAdds.splice(idx, 1);
                setActiveSection("Price");
                return;
            }

            const btn = e.target.closest('button[data-action]');
            if (!btn) return;

            const action = btn.getAttribute("data-action");
            const groupId = btn.getAttribute("data-group");

            function lock(group) { group.locked = true; }
            function unlock(group) { group.locked = false; }
            function clearMulti(group) { group.values = []; }
            function clearSingle(group) { group.value = ""; }

            if (action === "clearMaxBase") {
                state.priceMaxBase = null;
                setActiveSection("Price");
                return;
            }

            if (action === "lock") {
                if (groupId === "neighborhoodGroup") lock(state.neighborhood);
                if (groupId === "homeTypeGroup") lock(state.homeType);
                if (groupId === "bedroomGroup") lock(state.bedroom);
                if (groupId === "bathroomGroup") lock(state.bathroom);
                if (groupId === "motivationGroup") lock(state.motivation);
                if (groupId === "payTypeGroup") lock(state.payType);
                setActiveSection(state.activeSection);
                return;
            }

            if (action === "unlock") {
                if (groupId === "neighborhoodGroup") unlock(state.neighborhood);
                if (groupId === "homeTypeGroup") unlock(state.homeType);
                if (groupId === "bedroomGroup") unlock(state.bedroom);
                if (groupId === "bathroomGroup") unlock(state.bathroom);
                if (groupId === "motivationGroup") unlock(state.motivation);
                if (groupId === "payTypeGroup") unlock(state.payType);

                if (groupId === "agentGroup") {
                    unlock(state.hasBroker);
                    clearSingle(state.hasBroker);
                }
                if (groupId === "preApprovedGroup") {
                    unlock(state.preApproved);
                    clearSingle(state.preApproved);
                }

                setActiveSection(state.activeSection);
                return;
            }

            if (action === "clear") {
                if (groupId === "neighborhoodGroup") clearMulti(state.neighborhood);
                if (groupId === "homeTypeGroup") clearMulti(state.homeType);
                if (groupId === "bedroomGroup") clearMulti(state.bedroom);
                if (groupId === "bathroomGroup") clearMulti(state.bathroom);
                if (groupId === "motivationGroup") clearMulti(state.motivation);
                if (groupId === "payTypeGroup") clearMulti(state.payType);

                if (groupId === "agentGroup") clearSingle(state.hasBroker);
                if (groupId === "preApprovedGroup") clearSingle(state.preApproved);

                setActiveSection(state.activeSection);
                return;
            }
        });

        contentBody.addEventListener("change", (e) => {
            const t = e.target;

            if (t && t.matches('input[data-action="stillMoving"]')) {
                state.stillMoving = t.value;
                setActiveSection("Location");
                return;
            }

            if (t && t.matches('input[data-action="stage"]')) {
                state.locationStage = t.value;
                setActiveSection("Location");
                const target = document.getElementById("locationQuestions");
                if (target) target.scrollIntoView({ behavior: "smooth", block: "start" });
                return;
            }

            if (t && t.matches('input[data-action="scope"]')) {
                state.searchScope = t.value;
                state.searchReason = "";
                setActiveSection("Location");
                return;
            }

            if (t && t.matches('input[data-action="reason"]')) {
                state.searchReason = t.value;
                setActiveSection("Location");
                return;
            }

            if (t && t.matches('input[data-action="minBase"]')) {
                state.priceMinBase = Number(t.value);
                setActiveSection("Price");
                return;
            }

            if (t && t.matches('input[data-action="maxBase"]')) {
                const val = Number(t.value);
                if (t.checked) {
                    state.priceMaxBase = val;
                    const all = contentBody.querySelectorAll('input[name="maxBase"]');
                    all.forEach(inp => {
                        if (inp !== t) inp.checked = false;
                    });
                } else {
                    state.priceMaxBase = null;
                }
                setActiveSection("Price");
                return;
            }

            if (t && t.matches('input[data-action="apptType"]')) {
                state.apptType = t.value;
                setActiveSection("Appointment");
                return;
            }

            if (t && t.id === "apptDateInput") {
                state.apptDate = t.value;
                renderSummary();
                return;
            }
            if (t && t.id === "apptTimeInput") {
                state.apptTime = t.value;
                renderSummary();
                return;
            }

            if (t && t.matches('input[type="checkbox"][data-group]')) {
                const groupId = t.getAttribute("data-group");
                const val = t.value;
                const checked = t.checked;

                if (groupId === "neighborhoodGroup" && !state.neighborhood.locked) {
                    state.neighborhood.values = toggleInArray(state.neighborhood.values, val, checked);
                    setActiveSection(state.activeSection); return;
                }
                if (groupId === "homeTypeGroup" && !state.homeType.locked) {
                    state.homeType.values = toggleInArray(state.homeType.values, val, checked);
                    setActiveSection(state.activeSection); return;
                }
                if (groupId === "bedroomGroup" && !state.bedroom.locked) {
                    state.bedroom.values = toggleInArray(state.bedroom.values, val, checked);
                    setActiveSection(state.activeSection); return;
                }
                if (groupId === "bathroomGroup" && !state.bathroom.locked) {
                    state.bathroom.values = toggleInArray(state.bathroom.values, val, checked);
                    setActiveSection(state.activeSection); return;
                }

                if (groupId === "motivationGroup" && !state.motivation.locked) {
                    state.motivation.values = toggleInArray(state.motivation.values, val, checked);
                    setActiveSection("Motivation"); return;
                }

                if (groupId === "agentGroup" && !state.hasBroker.locked) {
                    if (checked) {
                        state.hasBroker.value = val;
                        state.hasBroker.locked = true;
                    } else state.hasBroker.value = "";
                    setActiveSection("Agent"); return;
                }

                if (groupId === "payTypeGroup" && !state.payType.locked) {
                    state.payType.values = toggleInArray(state.payType.values, val, checked);
                    setActiveSection("Mortgage"); return;
                }

                if (groupId === "preApprovedGroup" && !state.preApproved.locked) {
                    if (checked) {
                        state.preApproved.value = val;
                        state.preApproved.locked = true;
                    } else state.preApproved.value = "";
                    setActiveSection("Mortgage"); return;
                }
            }
        });

        contentBody.addEventListener("input", (e) => {
            const t = e.target;
            if (t && t.matches("input[data-field]")) {
                const key = t.getAttribute("data-field");
                state[key] = t.value;
                renderSummary();
                return;
            }
        });

        document.addEventListener("keydown", (e) => {
            const tag = (e.target && e.target.tagName) ? e.target.tagName.toLowerCase() : "";
            if (tag === "input" || tag === "textarea" || (e.target && e.target.isContentEditable)) return;
            if (e.ctrlKey || e.metaKey || e.altKey) return;

            const map = { "1": "Location", "2": "Price", "3": "Motivation", "4": "Agent", "5": "Mortgage", "6": "Appointment" };
            if (map[e.key]) setActiveSection(map[e.key]);
        });

        const savedNotes = localStorage.getItem("notes") || "";
        noteBox.value = savedNotes;
        state.notes = savedNotes;

        const savedAuto = localStorage.getItem("autoSummaryUser") || "";
        if (savedAuto.trim()) {
            autoSummaryBox.value = savedAuto;
            state.autoSummaryDirty = true;
            autoSummaryHint.textContent = "You edited this. It will not auto-overwrite.";
        }

        noteBox.addEventListener("input", () => {
            state.notes = noteBox.value;
            localStorage.setItem("notes", state.notes);
        });

        autoSummaryBox.addEventListener("input", () => {
            state.autoSummaryDirty = true;
            localStorage.setItem("autoSummaryUser", autoSummaryBox.value);
            autoSummaryHint.textContent = "You edited this. It will not auto-overwrite.";
        });

        copySummaryBtn.addEventListener("click", async () => {
            const text = autoSummaryBox.value || "";
            try {
                await navigator.clipboard.writeText(text);
                copySummaryBtn.textContent = "Copied";
                setTimeout(() => copySummaryBtn.textContent = "Copy", 900);
            } catch {
                autoSummaryBox.focus();
                autoSummaryBox.select();
                document.execCommand("copy");
                copySummaryBtn.textContent = "Copied";
                setTimeout(() => copySummaryBtn.textContent = "Copy", 900);
            }
        });

        setActiveSection("Location");
    </script>
</body>

</html>
